<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add robust minimum set objective — add_robust_min_set_objective • robust.prioritizr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add robust minimum set objective — add_robust_min_set_objective"><meta name="description" content="Add an objective to a conservation planning problem that minimizes the cost
of the solution while ensuring that the solution is robust to uncertainty for
each feature group."><meta property="og:description" content="Add an objective to a conservation planning problem that minimizes the cost
of the solution while ensuring that the solution is robust to uncertainty for
each feature group."><meta property="og:image" content="https://frankiecho.github.io/robust.prioritizr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">robust.prioritizr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/robust.prioritizr.html">Getting started with robust systematic conservation planning</a></li>
    <li><a class="dropdown-item" href="../articles/climate-sdm.html">Example using simulated data from a species distribution model</a></li>
    <li><a class="dropdown-item" href="../articles/vic-cons-planning.html">Example using Victoria, Australia</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/frankiecho/robust.prioritizr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add robust minimum set objective</h1>
      <small class="dont-index">Source: <a href="https://github.com/frankiecho/robust.prioritizr/blob/master/R/add_robust_min_set_objective.R" class="external-link"><code>R/add_robust_min_set_objective.R</code></a></small>
      <div class="d-none name"><code>add_robust_min_set_objective.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add an objective to a conservation planning problem that minimizes the cost
of the solution while ensuring that the solution is robust to uncertainty for
each feature group.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_robust_min_set_objective</span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"chance"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><code><a href="https://prioritizr.net/reference/problem.html" class="external-link">prioritizr::problem()</a></code> object.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>character</code> value with the name of the probabilistic
constraint formulation method. Available options include the (<code>"chance"</code>)
chance constraint programming method (Charnes and Cooper 1959) or (<code>"cvar"</code>)
or the conditional value-at-risk method (Rockafellar and Uryasev 2000),
Defaults to <code>"chance"</code>. See the Details section for further information
on these methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An updated <code><a href="https://prioritizr.net/reference/problem.html" class="external-link">prioritizr::problem()</a></code> object with the objective added
to it.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The robust minimum set objective seeks to find the set of planning units at
a minimum cost such that the solution meets the targets in a robust manner for each
feature group. Two methods are provided for formulating
the optimization problem as a mixed integer linear programming problem.
These methods are the chance constraint programming method
(<code>method = "chance"</code>) and conditional value-at-risk method
(<code>method = "cvar"</code>). In particular, the chance constraint programming
method is associated a more intuitive interpretation for the
confidence level parameter (i.e.,
specified per <code>conf_level</code> with <code><a href="add_constant_robust_constraints.html">add_constant_robust_constraints()</a></code> or
<code><a href="add_variable_robust_constraints.html">add_variable_robust_constraints()</a></code>). Whereas, the
conditional value-at-risk constraint method may yield faster solve times.
This is because the conditional value-at-risk constraint method
preserves the convexity of an optimization problem,
and uses continuous (instead of binary) auxiliary variables.
Also note that the conditional value-at-risk constraint method may
produce an infeasible solution for problems that are feasible with
the chance constraint with the same <code>conf_level</code>. In such cases the chance
chance constraint programming method should be used instead.
As such, the chance constraint programming method may be
more useful for facilitating stakeholder involvement for small-scale
planning exercises, and the
conditional value-at-risk constraint method may be more useful for
large-scale applications.</p>
    </div>
    <div class="section level2">
    <h2 id="mathematical-formulation">Mathematical formulation<a class="anchor" aria-label="anchor" href="#mathematical-formulation"></a></h2>


<p>This objective can be expressed
mathematically for a set of planning units (\(I\) indexed by
\(i\)), a set of feature groups (\(J\) indexed by \(j\)), and
a set of features associated with each feature group
(\(K\) indexed by \(k\)). Let \(c_i\) denote the cost of
planning unit \(i\), \(r_{ijk}\) the amount of feature
\(k\) associated with planning unit \(i\) for feature group
\(j\), \(T_j\) the target for each feature group
\(j\), and \(\alpha\) the confidence level for uncertainty
(specified per <code>conf_level</code> with <code><a href="add_constant_robust_constraints.html">add_constant_robust_constraints()</a></code> or
<code><a href="add_variable_robust_constraints.html">add_variable_robust_constraints()</a></code>).
Additionally, to describe the decision variables,
let \(x_i\) denote the status of the planning unit \(i\)
(e.g., specifying whether
planning unit \(i\) has been selected or not with binary values).
Given this terminology, the robust minimum set formulation of the reserve
selection problem is formulated as follows.</p>
<p>$$
\mathit{Minimize} \space \sum_{i = 1}^{I} x_i c_i \\
\mathit{subject \space to} \\
\Pr_k \{ \sum_{i = 1}^{I} x_i r_{ijk} \geq T_j \}
\geq \alpha \quad \forall \space j \in J
$$</p>
<p>Here, the objective function (first equation) is to minimize the total
cost of the solution. The probabilistic constraints (second equation)
specify that the solution must achieve a particular probability threshold
(based on \(\alpha\)) for meeting the targets of the features
associated with each feature group.
For example, if \(\alpha=1\), then each and every target associated
with each feature group must be met.
Alternatively, if \(\alpha=0.5\), then the
solution must have a 50% chance of meeting the targets associated
with each feature group.
Approximation methods are used to linearize them so that the optimization
problem can be solved with mixed integer programming exact algorithm solvers.</p>
<p>The chance constraint programming method uses a "big-M" formulation
to linearize the probabilistic constraints (Charnes and Cooper 1959).
To describe this method, let \(m_{jk}\) denote a binary
auxiliary variable for each feature \(k\) associated with each
feature group \(j\). Also, let \(K_j\) denote a
pre-computed value describing the number of
features associated with each feature group \(j\).
Given this terminology, the method involves replacing the probabilistic
constraints with the following linear constraints.</p>
<p>$$
\sum_{i = 1}^{I} x_i r_{ijk} + T_j m_{jk} \geq T_{j} \quad
  \forall \space j \in J, \space k \in K \\
\sum_{k = 1}^{K_j} \frac{m_{jk}}{K_j} \leq 1 - \alpha \quad
  \forall \space j \in J \\
m_{jk} \in \{0, 1\} \quad
  \forall \space j \in J, \space k \in K
$$</p>
<p>Here, the solution is allowed to fail to meet the targets
for the features, and the auxiliary variable \(m_{jk}\) is
used to calculate the proportion of features that do not have their targets
met for each feature group. For a given feature group, the
proportion of features that do not have their target met is
constrained to be less than \(1 - \alpha\).
This method allows for an intuitive interpretation of the confidence level
parameter. Yet this method also adds \(J \times K\) binary
variables to the problem and, as such, may present long solve times for
problems with many other decision variables and constraints.</p>
<p>The conditional value-at-risk constraint method presents a tighter
formulation than the chance constraint programming method
(Rockafellar and Uryasev 2000).
As such, this method is able to better approximate the
probabilistic constraints and, in turn, could potentially yield
solutions that are more robust to uncertainty and less cost-efficient
than the chance constraint programming method.
To describe this method, let \(\eta_j\) denote
a continuous auxiliary variable for each feature group \(j\),
and \(s_{jk}\) a continuous auxiliary variable for each feature
\(k\) associated with each feature group \(j\).
Given this terminology, the method involves replacing the probabilistic
constraints with the following linear constraints.</p>
<p>$$
\sum_{i = 1}^{I} x_i r_{ijk} - \eta_j + s_{jk} \geq 0 \quad
  \forall \space j \in J, \space k \in K \\
\eta_j - \frac{1}{(1 - \alpha) \times K_j} \sum_{k=1}^{K_j} s_{jk} \geq T_j
  \quad \forall \space j \in J \\
s_{jk} \geq 0 \quad \forall \space j \in J, \space k \in K \\
\eta_j \in \mathbb{R}  \quad  \forall \space j \in J
$$</p>
<p>Here, the continuous auxiliary variables are used to represent the "tail" of
the distribution of the uncertain quantity
(i.e., \(\sum_{i=1}^{I} x_i r_{ijk}\)).
In other words, it ensures
that the average of amount of each feature held by the solution for
a particular feature group that falls below a particular
quantile (i.e., \((1 - \alpha)\)) is greater than the
target for the feature group (i.e., \(T_j\)).
Although this method does not provide an easily intuitive interpretation of
the confidence level parameter, it only adds \(J \times K + J\)
continuous variables to the problem.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Charnes A &amp; Cooper WW (1959) Chance-constrained programming.
<em>Management Science</em>, 6(1), 73–79.</p>
<p>Rockafellar RT &amp; Uryasev S (2000) Optimization of conditional value-at-risk.
<em>Journal of Risk</em>, 2(3), 21–42.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <a href="robust_objectives.html">robust_objectives</a> for an overview of all functions for adding
robust objectives.</p>
<p>Other functions for adding robust objectives:
<code><a href="add_robust_min_shortfall_objective.html">add_robust_min_shortfall_objective</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://prioritizr.net" class="external-link">prioritizr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get planning unit data</span></span></span>
<span class="r-in"><span><span class="va">pu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://prioritizr.net/reference/sim_data.html" class="external-link">get_sim_pu_raster</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get feature data</span></span></span>
<span class="r-in"><span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://prioritizr.net/reference/sim_data.html" class="external-link">get_sim_features</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the feature groups,</span></span></span>
<span class="r-in"><span><span class="co"># Here, we will assign the first 2 features to the group A, and</span></span></span>
<span class="r-in"><span><span class="co"># the remaining features to the group B</span></span></span>
<span class="r-in"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nlyr</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Build problem with chance constraint programming method</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://prioritizr.net/reference/problem.html" class="external-link">problem</a></span><span class="op">(</span><span class="va">pu</span>, <span class="va">features</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">add_robust_min_set_objective</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"cvar"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="add_constant_robust_constraints.html">add_constant_robust_constraints</a></span><span class="op">(</span>groups <span class="op">=</span> <span class="va">groups</span>, conf_level <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://prioritizr.net/reference/add_binary_decisions.html" class="external-link">add_binary_decisions</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://prioritizr.net/reference/add_relative_targets.html" class="external-link">add_relative_targets</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://prioritizr.net/reference/add_default_solver.html" class="external-link">add_default_solver</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Solve the problem</span></span></span>
<span class="r-in"><span><span class="va">soln</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the solution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">soln</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://frankiecho.github.io/" class="external-link">Frankie Cho</a>, <a href="https://jeffrey-hanson.com" class="external-link">Jeffrey O Hanson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

