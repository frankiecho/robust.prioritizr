"0","eval_soln_uncertain <- function(soln, return_df = FALSE) {"
"0","  dist <- values(soln * abundance_uncertainty) %>% "
"0","    unname %>% "
"0","    apply(2, sum, na.rm = T)"
"0","  df <- data.frame(groups = groups_uncertainty, value = dist) %>% "
"0","    mutate(target_met = if_else(value >= target, 'Target met', 'Target not met')) "
"0","  if (return_df) return(df)"
"0","  df %>%"
"0","    ggplot(aes(x = value, fill = target_met)) +"
"0","    geom_histogram() +"
"0","    geom_vline(xintercept = target) +"
"0","    facet_wrap(vars(groups), ncol = 1) +"
"0","    scale_fill_manual(values = c('#0072B2', '#D55E00')) +"
"0","    theme_bw() +"
"0","    theme(panel.grid = element_blank())"
"0","}"
"0","eval_soln_uncertain(rs2a)"
