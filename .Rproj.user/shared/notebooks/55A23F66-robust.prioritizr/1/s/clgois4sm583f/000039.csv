"0","# Number of simulations"
"0","n_sims <- 500"
"0","sim_feature_1 <- replicate(n_sims, matrix(rnorm(N^2, mean = mu, sd = sigma), nrow = N, ncol = N)) %>%"
"0","  rast"
"0","feature_1_outcomes <- sim_feature_1 * s1"
"0","feature_1_targets <- values(feature_1_outcomes) %>%"
"0","  apply(2, sum) %>%"
"0","  unname"
"0",""
"0","expected_target <- sum(df$feature_1 * df$solution)"
"0",""
"0","data.frame(feature_1 = unname(feature_1_targets)) %>%"
"0","  mutate(violated = if_else(feature_1 < target, ""Below target"", ""Above target"")) %>%"
"0","  mutate(violated = factor(violated, c(""Below target"", ""Above target""))) %>%"
"0","  ggplot(aes(x = feature_1, fill = violated)) +"
"0","  geom_histogram(color = 'white', bins = 30) +"
"0","  theme_bw() +"
"0","  geom_vline(xintercept = target, linetype = 2) +"
"0","  geom_vline(xintercept = expected_target, color = '#009e73') +"
"0","  scale_fill_manual('', values = c('#d55e00', '#0072b2'), drop = FALSE) +"
"0","  theme(panel.grid = element_blank())"
